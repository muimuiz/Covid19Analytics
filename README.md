# Variants.jl
東京都または大阪府における変異株の割合を、自治体が公表するゲノム解析データ*1から分析し予測する。

言語は Julia を用いており、処理は以下のような複数のファイルと module に分割されている。

- Variants.jl 変異ゲノム検査の結果をもとに手動で作成した CSV を読み込み、割合やオッズといった統計量を算出して DataFrame とする。2変異株の比の対数（ロジット）が時間に関する 1 次関数となるというロジット・モデルを元に、ロジスティック回帰手法によってパラメーター空間を探索して最尤値のパラメーターを求める。探索は Julia の GLM（一般化線形モデル）、R 言語の GLM、Julia で組んだニュートン法の3種で行う（これらは理論的にはすべて同じものを求めるが、結果の妥当性を相互に検証するために多重に計算している）。データが時系列の一定区間ごとのビンの形で集計されているため、時間に関して補正をかけ、繰り返しパラメーター探索を行う。この点を含むコードに含まれる数学的関係の導出に関しては別ファイルを参照*2。プログラムの実行のためには、module 内のメイン関数を地域を表すシンボル引数をつけて実行する (Variants.main(:tokyo))。
- Variants_Plots.jl 上プログラムで作成されたデータに基づきプロットを作成する。同様に、module 内のメイン関数を地域を表すシンボル引数をつけて実行する。返り値として、Plot を値とする辞書型変数を返す。

なお CSV ファイルはサンプルであり、Github 上での更新の予定はない。

*1 [【令和4年度】東京都新型コロナウイルス感染症モニタリング会議・分析資料（東京都防災ホームページ）](URL https://www.bousai.metro.tokyo.lg.jp/taisaku/saigai/1021348/index.html) ; [【令和5年度】東京都新型コロナウイルス感染症モニタリング会議・分析資料（東京都防災ホームページ）](URL https://www.bousai.metro.tokyo.lg.jp/taisaku/saigai/1023407/index.html)

*2 [時間区間で集計されたデータに対する正規分布近似を行わないロジスティック回帰の数値的解法についての覚書き](logitreg.md)
